<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="./src/js/jquery.js"></script>
    <title>我的钱包</title>
    <style>
        .yue{font-weight: bold;color:blue}
    </style>
</head>
<body>
    <table border="2">
        <thead>
          <tr>
              <th></th>
              <th>交通银行</th>
              <th>兴业银行</th>
              <th>京东白条</th>
              <th>花呗</th>
              <th>借呗</th>
              <th>合计</th>
          </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    总信用额度
                </td>
                <td>
                    <span class="yue" id="jiaotong_t"></span>
                </td>
                <td>
                    <span class="yue" id="xingye_t"></span>
                </td>
                <td>
                    <span class="yue" id="baitiao_t"></span>
                </td>
                <td>
                    <span class="yue" id="huabei_t"></span>
                </td>
                <td>
                    <span class="yue" id="jiebei_t"></span>
                </td>
                <td>
                    <span class="yue" id="total_t"></span>
                </td>
            </tr>
            <tr>
                <td>
                    可用额度
                </td>
                <td>
                    <input type="text" name="jiaotong" id="jiaotong" value="0" onkeyup="onlyMoney(this)">
                </td>
                <td>
                    <input type="text" name="xingye" id="xingye" value="0" onkeyup="onlyMoney(this)">
                </td>
                <td>
                    <input type="text" name="baitiao" id="baitiao" value="0" onkeyup="onlyMoney(this)">
                </td>
                <td>
                    <input type="text" name="huabei" id="huabei" value="0" onkeyup="onlyMoney(this)">
                </td>
                <td>
                    <input type="text" name="jiebei" id="jiebei" value="0" onkeyup="onlyMoney(this)">
                </td>
                <td>
                    <input type="text" id="total_c" value="">
                </td>
            </tr>
            <tr>
                <td>
                    待还金额
                </td>
                <td>
                    <span id="jiaotong_h" class="yue"></span>
                </td>
                <td>
                    <span id="xingye_h" class="yue"></span>
                </td>
                <td>
                    <span id="baitiao_h" class="yue"></span>
                </td>
                <td>
                    <span id="huabei_h" class="yue"></span>
                </td>
                <td>
                    <span id="jiebei_h" class="yue"></span>
                </td>
                <td>
                    <span id="total_h" class="yue"></span>
                </td>
            </tr>

            <tr>
                <td>
                    现金余额
                </td>
                <td>
                    <input type="text" name="yue" id="yue" value="10000">
                </td>
                <td>
                    <button type="button" name="button" id="button">计算</button>
                </td>
                <td colspan="3">
                    净余额: <span class="yue" id="jingyue"></span> 元
                </td>
            </tr>
        </tbody>
    </table>

    <script>

        $(function () {
            var jiaotong_t = 30000;
            var xingye_t = 27000;
            var baitiao_t = 180;
            var huabei_t = 23000;
            var jiebei_t = 40000;
            var total_t = jiaotong_t + xingye_t + baitiao_t + huabei_t + jiebei_t;

            $("#jiaotong_t").text('￥：' + jiaotong_t);
            $("#xingye_t").text('￥：' + xingye_t);
            $("#baitiao_t").text('￥：' + baitiao_t);
            $("#huabei_t").text('￥：' + huabei_t);
            $("#jiebei_t").text('￥：' + jiebei_t);
            $("#total_t").text('￥：' + total_t.toFixed(2));

            $("#button").click(function () {
                var jiaotong_c = parseFloat($("#jiaotong").val());
                var xingye_c = parseFloat($("#xingye").val());
                var baitiao_c = parseFloat($("#baitiao").val());
                var huabei_c = parseFloat($("#huabei").val());
                var jiebei_c = parseFloat($("#jiebei").val());
                var yue = parseFloat($("#yue").val());

                if((jiaotong_t-jiaotong_c) < 0) {
                    alert('当前余额大于总额度');return;
                }else {
                    var jiaotong_h = (jiaotong_t-jiaotong_c).toFixed(2);
                }
                if((xingye_t-xingye_c) < 0) {
                    alert('当前余额大于总额度');return;
                }else {
                    var xingye_h = (xingye_t-xingye_c).toFixed(2);
                }
                if((baitiao_t-baitiao_c) < 0) {
                    alert('当前余额大于总额度');return;
                }else {
                    var baitiao_h = (baitiao_t-baitiao_c).toFixed(2);
                }
                if((huabei_t-huabei_c) < 0) {
                    alert('当前余额大于总额度');return;
                }else {
                    var huabei_h = (huabei_t-huabei_c).toFixed(2);
                }
                if((jiebei_t-jiebei_c)<0) {
                    alert('当前余额大于总额度');return;
                }else {
                    var jiebei_h = (jiebei_t-jiebei_c).toFixed(2);
                }

                var total_c = jiaotong_c + xingye_c + baitiao_c + huabei_c + jiebei_c;
                var total_h = parseFloat(jiaotong_h) + parseFloat(xingye_h) + parseFloat(baitiao_h) + parseFloat(huabei_h) + parseFloat(jiebei_h);

                $("#total_c").val(total_c.toFixed(2));

                $("#jiaotong_h").text('￥：' + jiaotong_h);
                $("#xingye_h").text('￥：' + xingye_h);
                $("#baitiao_h").text('￥：' + baitiao_h);
                $("#huabei_h").text('￥：' + huabei_h);
                $("#jiebei_h").text('￥：' + jiebei_h);
                $("#total_h").text('￥：' + total_h.toFixed(2));

                var jingyue = (yue - parseFloat(total_h)).toFixed(2);
                $("#jingyue").text('￥：'+ jingyue);

            })
        });

        function onlyMoney(obj){
            //先把非数字的都替换掉，除了数字和.    
            obj.value = obj.value.replace(/[^\d\.]/g,'');

            //第一位不能是数字0      
            obj.value = obj.value.replace(/^0\d[0-9]*/g,'');

            //必须保证第一个为数字而不是.       
            obj.value = obj.value.replace(/^\./g,'');

            //小数点后面最多两位       
            obj.value = obj.value.replace(/(\.\d{2})\d*/g,"$1");

            //小数点前面最多八位       
            obj.value = obj.value.replace(/(\d{5})\d*/g,"$1");

            //保证没有连续的.   保证.只出现一次，而不能出现两次以上      
            obj.value = obj.value.replace('.','$#$').replace(/\./g,'').replace('$#$','.');

        }


    </script>

</body>
</html>